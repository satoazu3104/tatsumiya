{"version":3,"file":"assets/js/blocks/medias.js","mappings":"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","sources":["webpack://portart/./src/js/blocks/component/MediaUpload/ImageSelector.js","webpack://portart/external window [\"wp\",\"blockEditor\"]","webpack://portart/external window [\"wp\",\"components\"]","webpack://portart/external window [\"wp\",\"element\"]","webpack://portart/webpack/bootstrap","webpack://portart/webpack/runtime/compat get default export","webpack://portart/webpack/runtime/define property getters","webpack://portart/webpack/runtime/hasOwnProperty shorthand","webpack://portart/external window [\"wp\",\"blocks\"]","webpack://portart/external window [\"wp\",\"apiFetch\"]","webpack://portart/./src/js/blocks/medias.js"],"sourcesContent":["import { Button } from '@wordpress/components';\nimport { MediaUpload, MediaUploadCheck } from '@wordpress/block-editor';\nimport { useState } from '@wordpress/element';\n\nconst ImageSelector = ({...props}) => {\n  let attributes = props.attributes;\n  const index = props.index;\n  const setAttributes = props.setAttributes;\n  let count = props.count;\n  const slug = props.slug;\n  const single = index === undefined;\n  \n  const [newMedia, setNewMedia] = useState(!single ? attributes[index][slug] : attributes[slug]);\n  console.log(single);\n  \n  const onSelectImage = (media, slug, index) => {\n    if (media && media.url) {\n      if(!single) {\n        let newArray = attributes;\n        console.log(newArray);\n        newArray[index][slug] = media.url;\n        setNewMedia(media.url);\n        setAttributes({\n          blocksData: newArray,\n          count: count++\n        });\n      } else {\n        setNewMedia(media.url);\n        setAttributes({\n          [slug]: media.url,\n        });\n      }\n    }\n  }\n  const removeMedia = (slug, index) => {\n    if(!single) {\n    let newArray = attributes;\n    newArray[index][slug] = '';\n    setNewMedia('');\n    setAttributes({\n      blocksData: newArray,\n      count: count++\n     });\n    } else {\n      setNewMedia('');\n      setAttributes({\n        [slug]: '',\n      });\n    }\n  }\n  \n  if(!single) {\n    return(\n      <>\n      {/* 画像が設定されている場合は表示 */}\n      {newMedia && <img src={newMedia} alt=\"Uploaded Image\" />}\n\n      {/* 画像を選択するコンポーネント */}\n      <MediaUploadCheck>\n        <MediaUpload\n          onSelect={(media) => onSelectImage(media, slug, index)}\n          allowedTypes={['image']}\n          value={attributes[index][slug]}\n          render={({ open }) => (\n            <Button onClick={open} isPrimary>\n              画像を選択\n            </Button>\n          )}\n        />\n      </MediaUploadCheck>\n      {attributes[slug] !== '' &&\n        <MediaUploadCheck>\n          <Button\n            onClick={() => removeMedia(slug, index)}\n            isLink\n            isDestructive\n            className=\"removeImage\">\n            画像を削除\n          </Button>\n        </MediaUploadCheck>\n      }\n      </>\n    )\n  } else {\n    return (\n      <>\n        {/* 画像が設定されている場合は表示 */}\n        {newMedia && <img className='b-media__img' src={newMedia} alt=\"Uploaded Image\" />}\n\n        {/* 画像を選択するコンポーネント */}\n        <MediaUploadCheck>\n          <MediaUpload\n            onSelect={(media) => onSelectImage(media, slug)}\n            allowedTypes={['image']}\n            value={attributes[slug]}\n            render={({ open }) => (\n              <Button onClick={open} isPrimary>\n                画像を選択\n              </Button>\n            )}\n          />\n        </MediaUploadCheck>\n        {attributes[slug] !== '' &&\n          <MediaUploadCheck>\n            <Button\n              onClick={() => removeMedia(slug)}\n              isLink\n              isDestructive\n              className=\"removeImage\">\n              画像を削除\n            </Button>\n          </MediaUploadCheck>\n        }\n      </>\n    )\n  }\n}\n\nexport default ImageSelector; ","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"apiFetch\"];","import { registerBlockType } from '@wordpress/blocks';\nimport { Button, Modal, TextControl, SelectControl, TextareaControl } from '@wordpress/components';\nimport { RichText, MediaUpload, MediaUploadCheck, InspectorControls, PanelColorSettings } from '@wordpress/block-editor';\nimport { ImageSelector, useImageFunctions } from './component/MediaUpload';\nimport { useState, useEffect } from '@wordpress/element';\nimport apiFetch from '@wordpress/api-fetch';\n\nregisterBlockType('portart/medias', {\n  title: '画像',\n  icon: 'smiley',\n  category: 'layout',\n  attributes: {\n    imageUploadUrl: {\n      type: 'string',\n      default: ''\n    },\n    mobileImageUploadUrl: { // モバイル用画像URLの属性を追加\n      type: 'string',\n      default: ''\n    },\n    addAttr: {\n      type: 'string',\n      default: '',\n    },\n    imageUrl: {\n      type: 'string',\n      default: ''\n    },\n    mobileImageUrl: { // モバイル用画像URLの属性を追加\n      type: 'string',\n      default: ''\n    },\n    addClassName: {\n      type: 'string',\n      default: '',\n    },\n  },\n\n  edit: ({ className, attributes, setAttributes }) => {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n\n    const openModal = () => setIsModalOpen(true);\n    const closeModal = () => setIsModalOpen(false);\n\n    const onChangeAttr = (newAttr) => {\n      setAttributes({\n        addAttr: newAttr\n      });\n    }\n\n    const ThemeImagesSelector = ({ onImageSelect, imageUrl, label }) => {\n      const [images, setImages] = useState([]);\n      const [isLoading, setIsLoading] = useState(true);\n\n      useEffect(() => {\n        // REST APIエンドポイントから画像の一覧を取得\n        apiFetch({ path: '/mytheme/v1/theme-images/' }).then((images) => {\n          setImages(images);\n          setIsLoading(false);\n        });\n      }, []);\n\n      const value = images.find(image => image.url === portartMedia.themeUrl + imageUrl)?.url || '';\n\n      return isLoading ? (\n        <p>Loading...</p>\n      ) : (\n        <SelectControl\n          label={label ?? \"テーマの画像を選択\"}\n          value={value}\n          options={[\n            { label: '画像を選択', value: '' }, // デフォルトの選択肢を追加\n            ...images.map((image) => ({\n              label: image.name,\n              value: image.url,\n            }))\n          ]}\n          onChange={(imageURL) => onImageSelect(imageURL)}\n        />\n      );\n    };\n    const { imageUrl, mobileImageUrl, imageUploadUrl, addAttr, mobileImageUploadUrl, addClassName } = attributes;\n\n    const themeDirectoryImageUrl = `${portartMedia.themeUrl}/dist/assets/images/`;\n\n    // メディアライブラリから画像を選択する\n    const onImageSelect = (imageURL) => {\n      const relativeUrl = imageURL.replace(new RegExp(`^${portartMedia.themeUrl}`), '');\n      setAttributes({ imageUrl: relativeUrl });\n    };\n\n    const onMobileImageSelect = (imageURL) => {\n      const relativeUrl = imageURL.replace(new RegExp(`^${portartMedia.themeUrl}`), '');\n      setAttributes({ mobileImageUrl: relativeUrl });\n    };\n\n    return (\n      <>\n        <InspectorControls>\n          <div className='components-base-control'>\n            {/* デスクトップ用画像のアップロード */}\n            <p>\n              デスクトップ用画像のアップロード\n            </p>\n            <ImageSelector attributes={attributes} setAttributes={setAttributes} slug=\"imageUploadUrl\" />\n          </div>\n\n          <div className='components-base-control'>\n            {/* モバイル用画像のアップロード */}\n            <p>\n              モバイル用画像のアップロード\n            </p>\n            <ImageSelector attributes={attributes} setAttributes={setAttributes} slug=\"mobileImageUploadUrl\" />\n          </div>\n\n          <TextareaControl\n            label=\"追加class\"\n            value={addClassName}\n            onChange={(newText) => {\n              setAttributes({\n                addClassName: newText\n              })\n            }}\n          />\n          <TextControl\n            label=\"追加Attr\"\n            value={addAttr}\n            onChange={onChangeAttr}\n          />\n        </InspectorControls>\n\n        {isModalOpen && (\n          <Modal\n            title=\"画像を選択\"\n            onRequestClose={closeModal}\n          >\n\n            <ThemeImagesSelector imageUrl={imageUrl} onImageSelect={onImageSelect} />\n            <ThemeImagesSelector label={'スマホのテーマ画像を選択'} imageUrl={mobileImageUrl} onImageSelect={onMobileImageSelect} />\n\n            <Button isPrimary onClick={closeModal}>\n              閉じる\n            </Button>\n          </Modal>\n        )}\n\n        <div className='b-media__group'>\n          <Button isPrimary onClick={openModal}>\n            テーマフォルダから画像を選択する\n          </Button>\n\n          <div className='b-media__group__inner'>\n            {(imageUrl || imageUploadUrl) && (\n              <>\n                <div>\n                  <p>PC画像</p>\n                  <img className='b-media__img' src={imageUploadUrl ? imageUploadUrl : (portartMedia.themeUrl + imageUrl)} alt=\"\" />\n                </div>\n              </>\n            )}\n            {(mobileImageUrl || mobileImageUploadUrl) && (\n              <>\n                <div>\n                  <p>スマホ画像</p>\n                  <img className='b-media__img' src={mobileImageUploadUrl ? mobileImageUploadUrl : (portartMedia.themeUrl + mobileImageUrl)} alt=\"\" />\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n      </>\n    )\n  },\n  save: ({ attributes }) => {\n    const { imageUrl, mobileImageUrl, imageUploadUrl, mobileImageUploadUrl, addClassName, addAttr } = attributes;\n    const loadClass = addClassName + '\\n';\n    const fixClass = loadClass.replace(/\\n/g, ' ');\n    const fixPictureClass = loadClass.replace(/\\n/g, '__picture ');\n\n    const attrArray = addAttr.split(' ');\n    let attrs = {};\n    for (let i = 0; i < attrArray.length; i++) {\n      const label = attrArray[i].substr(0, attrArray[i].indexOf('='));\n      const value = attrArray[i].substr((attrArray[i].indexOf('=') + 1)).replace(/\"/g, '');\n      attrs[label] = value;\n    }\n\n    return (\n      <>\n        {(imageUrl || imageUploadUrl) && (\n          <picture className={fixPictureClass}>\n            {(mobileImageUrl || mobileImageUploadUrl) && (\n              <source className={mobileImageUploadUrl ? fixClass : fixClass + 'block-media'} data-src={mobileImageUrl} srcSet={mobileImageUploadUrl ? mobileImageUploadUrl : ''} media=\"(max-width: 1024px)\" />\n            )}\n            <img {...attrs} className={imageUploadUrl ? fixClass : fixClass + 'block-media'} data-src={imageUrl} src={imageUploadUrl ? imageUploadUrl : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC'} alt=\"media\" />\n          </picture>\n        )}\n      </>\n    )\n  },\n});"],"names":["ImageSelector","props","attributes","index","setAttributes","count","slug","single","undefined","newMedia","setNewMedia","useState","console","log","onSelectImage","media","url","newArray","blocksData","removeMedia","wp","element","createElement","Fragment","className","src","alt","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","MediaUploadCheck","MediaUpload","onSelect","allowedTypes","value","render","open","Button","onClick","isPrimary","isLink","isDestructive","module","exports","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","registerBlockType","title","icon","category","imageUploadUrl","type","default","mobileImageUploadUrl","addAttr","imageUrl","mobileImageUrl","addClassName","edit","isModalOpen","setIsModalOpen","closeModal","ThemeImagesSelector","onImageSelect","label","images","setImages","isLoading","setIsLoading","useEffect","apiFetch","path","then","find","image","portartMedia","themeUrl","SelectControl","options","map","name","onChange","imageURL","InspectorControls","TextareaControl","newText","TextControl","newAttr","Modal","onRequestClose","relativeUrl","replace","RegExp","openModal","save","loadClass","fixClass","fixPictureClass","attrArray","split","attrs","i","length","substr","indexOf","srcSet","_extends"],"sourceRoot":""}